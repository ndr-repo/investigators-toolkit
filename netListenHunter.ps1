Write-Output "`n" ; Get-NetTCPConnection | Where-Object -Property State -EQ Listen | Select-Object -ExpandProperty OwningProcess -Unique | % { Get-Process -Id $_ | Select-Object -ExpandProperty Path | Out-String -Stream | % { Get-FileHash -Path  $_ -ErrorAction SilentlyContinue | Select-Object -ExpandProperty Path ; Get-FileHash -Path $_ -ErrorAction SilentlyContinue | Select-Object -ExpandProperty Hash | % { Write-Output "Open Threat Exchange - sha256:$_" ; Invoke-RestMethod -Method Get -Uri "https://otx.alienvault.com/api/v1/indicators/file/$_/general" } } }
